#!/bin/bash

CURRENT_USER=$(whoami)

# Demander le mot de passe
NEW_PASS=$(zenity --password \
    --title="Nouveau mot de passe" \
    --width=400 \
    --height=100 \
    --text="Veuillez entrer votre nouveau mot de passe")

# Vérifier annulation
if [ $? -ne 0 ]; then
    exit 1
fi

# Demander la confirmation
CONFIRM_PASS=$(zenity --password \
    --title="Confirmer le mot de passe" \
    --width=400 \
    --height=100 \
    --text="Veuillez confirmer votre nouveau mot de passe")

if [ $? -ne 0 ]; then
    exit 1
fi

# Vérifier si les mots de passe correspondent
if [ "$NEW_PASS" != "$CONFIRM_PASS" ]; then
    zenity --error --text="❌ Les mots de passe ne correspondent pas."
    exit 1
fi

# Changer le mot de passe
echo "$CURRENT_USER:$NEW_PASS" | sudo chpasswd

# Confirmation
zenity --info --text="✅ Mot de passe modifié avec succès."
